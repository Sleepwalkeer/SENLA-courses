<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
      http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.1.xsd"
        logicalFilePath="homework-2">

    <changeSet id="credentials-table" author="Vladislav Krot">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="credentials"/>
            </not>
        </preConditions>
        <sqlFile encoding="utf8" path="./sql/01.create-credentials-table.sql" relativeToChangelogFile="true"/>
    </changeSet>

    <changeSet id="account-table" author="Vladislav Krot">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="account"/>
            </not>
        </preConditions>
        <sqlFile encoding="utf8" path="./sql/02.create-account-table.sql" relativeToChangelogFile="true"/>
    </changeSet>

    <changeSet id="account-first_name" author="Vladislav Krot">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists tableName="account"
                              columnName="first_name"/>
            </not>
        </preConditions>
        <sqlFile encoding="utf8" path="./sql/03.account-add-first_name.sql" relativeToChangelogFile="true"/>
    </changeSet>

    <changeSet id="account-second_name" author="Vladislav Krot">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists tableName="account"
                              columnName="second_name"/>
            </not>
        </preConditions>
        <sqlFile encoding="utf8" path="./sql/04.account-add-second_name.sql" relativeToChangelogFile="true"/>
    </changeSet>

    <changeSet id="account-phone" author="Vladislav Krot">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists tableName="account"
                              columnName="phone"/>
            </not>
        </preConditions>
        <sqlFile encoding="utf8" path="./sql/05.account-add-phone.sql" relativeToChangelogFile="true"/>
    </changeSet>

    <changeSet id="account-email" author="Vladislav Krot">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists tableName="account"
                              columnName="email"/>
            </not>
        </preConditions>
        <sqlFile encoding="utf8" path="./sql/06.account-add-email.sql" relativeToChangelogFile="true"/>
    </changeSet>

    <changeSet id="order_item-table" author="Vladislav Krot">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="order_item"/>
            </not>
        </preConditions>
        <sqlFile encoding="utf8" path="./sql/07.create-order_item-table.sql" relativeToChangelogFile="true"/>
    </changeSet>

    <changeSet id="rent_order-table" author="Vladislav Krot">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="rent_order"/>
            </not>
        </preConditions>
        <sqlFile encoding="utf8" path="./sql/08.create-rent_order-table.sql" relativeToChangelogFile="true"/>
    </changeSet>

    <changeSet id="item-table" author="Vladislav Krot">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="item"/>
            </not>
        </preConditions>
        <sqlFile encoding="utf8" path="./sql/09.create-item-table.sql" relativeToChangelogFile="true"/>
    </changeSet>

    <changeSet id="category-table" author="Vladislav Krot">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="category"/>
            </not>
        </preConditions>
        <sqlFile encoding="utf8" path="./sql/10.create-category-table.sql" relativeToChangelogFile="true"/>
    </changeSet>

    <changeSet id="credentials-username" author="Vladislav Krot">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists tableName="credentials"
                              columnName="username"/>
            </not>
        </preConditions>
        <sqlFile encoding="utf8" path="./sql/11.credentials-add-username.sql" relativeToChangelogFile="true"/>
    </changeSet>

    <changeSet id="credentials-password" author="Vladislav Krot">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists tableName="credentials"
                              columnName="password"/>
            </not>
        </preConditions>
        <sqlFile encoding="utf8" path="./sql/12.credentials-add-password.sql" relativeToChangelogFile="true"/>
    </changeSet>

    <changeSet id="order_item-cnstr-fk_order_id" author="Vladislav Krot">
        <preConditions onFail="MARK_RAN">
            <not>
                <foreignKeyConstraintExists foreignKeyName="fk_order_id"/>
            </not>
        </preConditions>
        <sqlFile encoding="utf8" path="./sql/13.order_item-add-cnstr-fk_order_id.sql" relativeToChangelogFile="true"/>
    </changeSet>

    <changeSet id="order_item-cnstr-fk_item_id" author="Vladislav Krot">
        <preConditions onFail="MARK_RAN">
            <not>
                <foreignKeyConstraintExists foreignKeyName="fk_item_id"/>
            </not>
        </preConditions>
        <sqlFile encoding="utf8" path="./sql/14.order_item-add-cnstr-fk_item_id.sql" relativeToChangelogFile="true"/>
    </changeSet>

    <changeSet id="rent_order-customer_id" author="Vladislav Krot">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists tableName="rent_order"
                              columnName="customer_id"/>
            </not>
        </preConditions>
        <sqlFile encoding="utf8" path="./sql/15.rent_order-add-customer_id.sql" relativeToChangelogFile="true"/>
    </changeSet>

    <changeSet id="rent_order-worker_id" author="Vladislav Krot">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists tableName="rent_order"
                              columnName="worker_id"/>
            </not>
        </preConditions>
        <sqlFile encoding="utf8" path="./sql/16.rent_order-add-worker_id.sql" relativeToChangelogFile="true"/>
    </changeSet>

    <changeSet id="rent_order-start_datetime" author="Vladislav Krot">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists tableName="rent_order"
                              columnName="start_datetime"/>
            </not>
        </preConditions>
        <sqlFile encoding="utf8" path="./sql/17.rent_order-add-start_datetime.sql" relativeToChangelogFile="true"/>
    </changeSet>

    <changeSet id="rent_order-end_datetime" author="Vladislav Krot">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists tableName="rent_order"
                              columnName="end_datetime"/>
            </not>
        </preConditions>
        <sqlFile encoding="utf8" path="./sql/18.rent_order-add-end_datetime.sql" relativeToChangelogFile="true"/>
    </changeSet>

    <changeSet id="rent_order-total_price" author="Vladislav Krot">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists tableName="rent_order"
                              columnName="total_price"/>
            </not>
        </preConditions>
        <sqlFile encoding="utf8" path="./sql/19.rent_order-add-total_price.sql" relativeToChangelogFile="true"/>
    </changeSet>

    <changeSet id="rent_order-cnstr_fk_customer" author="Vladislav Krot">
        <preConditions onFail="MARK_RAN">
            <not>
                <foreignKeyConstraintExists foreignKeyName="fk_customer"/>
            </not>
        </preConditions>
        <sqlFile encoding="utf8" path="./sql/20.rent_order-add-cnstr-fk_customer.sql" relativeToChangelogFile="true"/>
    </changeSet>

    <changeSet id="rent_order-cnstr_fk_worker" author="Vladislav Krot">
        <preConditions onFail="MARK_RAN">
            <not>
                <foreignKeyConstraintExists foreignKeyName="fk_worker"/>
            </not>
        </preConditions>
        <sqlFile encoding="utf8" path="./sql/21.rent_order-add-cnstr-fk_worker.sql" relativeToChangelogFile="true"/>
    </changeSet>

    <changeSet id="item-category_id" author="Vladislav Krot">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists tableName="item"
                              columnName="category_id"/>
            </not>
        </preConditions>
        <sqlFile encoding="utf8" path="./sql/22.item-add-category_id.sql" relativeToChangelogFile="true"/>
    </changeSet>

    <changeSet id="item-name" author="Vladislav Krot">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists tableName="item"
                              columnName="name"/>
            </not>
        </preConditions>
        <sqlFile encoding="utf8" path="./sql/23.item-add-name.sql" relativeToChangelogFile="true"/>
    </changeSet>

    <changeSet id="item-price" author="Vladislav Krot">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists tableName="item"
                              columnName="price"/>
            </not>
        </preConditions>
        <sqlFile encoding="utf8" path="./sql/24.item-add-price.sql" relativeToChangelogFile="true"/>
    </changeSet>

    <changeSet id="item-quantity" author="Vladislav Krot">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists tableName="item"
                              columnName="quantity"/>
            </not>
        </preConditions>
        <sqlFile encoding="utf8" path="./sql/25.item-add-quantity.sql" relativeToChangelogFile="true"/>
    </changeSet>

    <changeSet id="item-cnstr-fk_category" author="Vladislav Krot">
        <preConditions onFail="MARK_RAN">
            <not>
                <foreignKeyConstraintExists foreignKeyName="fk_category"/>
            </not>
        </preConditions>
        <sqlFile encoding="utf8" path="./sql/26.item-add-cnstr-fk_category.sql" relativeToChangelogFile="true"/>
    </changeSet>

    <changeSet id="category-name" author="Vladislav Krot">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists tableName="category"
                              columnName="name"/>
            </not>
        </preConditions>
        <sqlFile encoding="utf8" path="./sql/27.category-add-name.sql" relativeToChangelogFile="true"/>
    </changeSet>

    <changeSet id="item-index-index_id" author="Vladislav Krot">
        <preConditions onFail="MARK_RAN">
            <not>
                <indexExists indexName="index_id"/>
            </not>
        </preConditions>
        <sqlFile encoding="utf8" path="./sql/28.item-add-index-index_id.sql" relativeToChangelogFile="true"/>
    </changeSet>

    <changeSet id="rent_order-index-index_worker_id" author="Vladislav Krot">
        <preConditions onFail="MARK_RAN">
            <not>
                <indexExists indexName="index_worker_id "/>
            </not>
        </preConditions>
        <sqlFile encoding="utf8" path="./sql/29.rent_order-add-index-index_worker_id.sql"
                 relativeToChangelogFile="true"/>
    </changeSet>

    <changeSet id="rent_order-index-index_customer_id" author="Vladislav Krot">
        <preConditions onFail="MARK_RAN">
            <not>
                <indexExists indexName="index_customer_id"/>
            </not>
        </preConditions>
        <sqlFile encoding="utf8" path="./sql/30.rent_order-add-index-index_customer_id.sql"
                 relativeToChangelogFile="true"/>
    </changeSet>

    <changeSet id="credentials-role" author="Vladislav Krot">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists tableName="credentials"
                              columnName="role"/>
            </not>
        </preConditions>
        <sqlFile encoding="utf8" path="./sql/31.credentials-add-role.sql" relativeToChangelogFile="true"/>
    </changeSet>

    <changeSet id="account-discount" author="Vladislav Krot">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists tableName="account"
                              columnName="discount"/>
            </not>
        </preConditions>
        <sqlFile encoding="utf8" path="./sql/32.account-add-discount.sql" relativeToChangelogFile="true"/>
    </changeSet>

    <changeSet id="category-discount" author="Vladislav Krot">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists tableName="category"
                              columnName="discount"/>
            </not>
        </preConditions>
        <sqlFile encoding="utf8" path="./sql/33.category-add-discount.sql" relativeToChangelogFile="true"/>
    </changeSet>

    <changeSet id="item-discount" author="Vladislav Krot">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists tableName="item"
                              columnName="discount"/>
            </not>
        </preConditions>
        <sqlFile encoding="utf8" path="./sql/34.item-add-discount.sql" relativeToChangelogFile="true"/>
    </changeSet>

    <changeSet id="account-balance" author="Vladislav Krot">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists tableName="account"
                              columnName="balance"/>
            </not>
        </preConditions>
        <sqlFile encoding="utf8" path="./sql/35.account-add-balance.sql" relativeToChangelogFile="true"/>
    </changeSet>

</databaseChangeLog> 
